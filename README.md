本当にくそコードです。途中から50行程度で書く方法を思いつきましたが、もうやるしかありませんでした...
